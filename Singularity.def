Bootstrap: docker
From: debian:11
Stage: tools-base

%labels
Maintainer: Tim Molteno "tim@elec.ac.nz"
%post
    DEBIAN_FRONTEND=noninteractive

    # debian setup
    apt-get update && \
        apt-get install -y build-essential git pkg-config \
        curl python3-venv python3-setuptools python3-dev python3-wheel \
        python3-cffi libffi-dev libhdf5-dev \
        python3-numpy python3-scipy \
        python3-matplotlib \
        python3-h5py python3-astropy \
        python3-pandas python3-gmsh \
        python3-dask python3-healpy

    python3 -m venv /app/venv
    cd /app
    /app/venv/bin/pip install --no-cache-dir --no-compile tart2ms tart_tools tart disko
    /app/venv/bin/pip install --no-cache-dir --no-compile git+https://github.com/tmolteno/spotless


%environment
  export PATH=/app/venv/bin:$PATH

%runscript
  "$@"

